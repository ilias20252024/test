@{
    ViewData["Title"] = "Who I Am - WSP2 SecDevOps";
}

<div class="container">
    <h1>üë§ Who I Am - Sistema de Autenticaci√≥n</h1>
    <div class="warning">‚ö†Ô∏è VULNERABILIDADES: SQL Injection, Weak Auth, Session Issues</div>

    <div class="success">
        <h2>‚úÖ Sesi√≥n Activa</h2>
        <p><strong>Usuario:</strong> @ViewBag.Username</p>
        <p><strong>Rol:</strong> @ViewBag.Role</p>
        <p><strong>Session ID:</strong> @ViewBag.SessionId</p>
        <p><strong>√öltima actividad:</strong> @ViewBag.LastActivity</p>
        <p><strong>Tiempo m√°ximo inactivo:</strong> @ViewBag.MaxInactiveInterval segundos</p>
    </div>

    @if (ViewBag.Role == "admin")
    {
        <div class="admin-panel">
            <h3>üîß Panel de Administraci√≥n</h3>
            <p>Acceso a funciones administrativas:</p>
            <ul>
                <li><a href="#" onclick="executeCommand()">Ejecutar comandos del sistema</a></li>
                <li><a href="#" onclick="viewLogs()">Ver logs del sistema</a></li>
                <li><a href="#" onclick="accessDatabase()">Acceso directo a base de datos</a></li>
            </ul>
        </div>
    }

    <form method="post" action="@Url.Action("Logout")">
        <button type="submit" class="logout-btn">üö™ Cerrar Sesi√≥n</button>
    </form>

    <div class="navigation">
        <a href="/">üè† Volver al inicio</a>
        <a href="/headers">üìã Ver Headers</a>
    </div>
</div>

@section Scripts {
    <script>
        function executeCommand() {
            var cmd = prompt('Ingrese comando a ejecutar:');
            if (cmd) {
                alert('Ejecutando: ' + cmd + '\n(Esto es una simulaci√≥n de vulnerabilidad de Command Injection)');
            }
        }

        function viewLogs() {
            alert('Accediendo a logs del sistema...\n(Vulnerabilidad: Exposici√≥n de logs)');
        }

        function accessDatabase() {
            alert('Conexi√≥n directa a: jdbc:h2:mem:testdb\n(Vulnerabilidad: Acceso directo a DB)');
        }
    </script>
} 